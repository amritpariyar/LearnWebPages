@{
    Page.Title = "Delete Student";
    Layout = "~/_SiteLayout.cshtml";
    
    var studentId = Request.QueryString["id"];
    var firstName = "";
    var lastName = "";
    var email = "";
    var major = "";
    
    // Validate that an ID was provided
    if (studentId.IsEmpty() || !studentId.IsInt()) {
        Response.Redirect("~/Students.cshtml");
    }
    
    var db = Database.Open("CollegeSite");
    
    // If this is a POST request, delete the student
    if (IsPost) {
        AntiForgery.Validate();
        
        // Delete the student from the database
        db.Execute("DELETE FROM Students WHERE StudentId = @0", studentId);
        db.Close();
        
        // Redirect back to the students list
        Response.Redirect("~/Students.cshtml");
    }
    
    // Get student information for confirmation
    var student = db.QuerySingle("SELECT * FROM Students WHERE StudentId = @0", studentId);
    
    if (student == null) {
        db.Close();
        Response.Redirect("~/Students.cshtml");
    }
    
    firstName = student.FirstName;
    lastName = student.LastName;
    email = student.Email;
    major = student.Major;
    
    db.Close();
}

<hgroup class="title">
    <h1>@Page.Title</h1>
    <h2>Are you sure you want to delete this student?</h2>
</hgroup>

<div class="delete-confirmation">
    <div class="student-details">
        <h3>Student Information</h3>
        <dl>
            <dt>Student ID:</dt>
            <dd>@studentId</dd>
            
            <dt>Name:</dt>
            <dd>@firstName @lastName</dd>
            
            <dt>Email:</dt>
            <dd>@email</dd>
            
            <dt>Major:</dt>
            <dd>@major</dd>
            
            <dt>Date of Birth:</dt>
            <dd>@(student.DateOfBirth != null ? ((DateTime)student.DateOfBirth).ToString("MM/dd/yyyy") : "N/A")</dd>
            
            <dt>Enrollment Date:</dt>
            <dd>@student.EnrollmentDate.ToString("MM/dd/yyyy")</dd>
        </dl>
    </div>
    
    <div class="warning-message">
        <p>?? <strong>Warning:</strong> This action cannot be undone. The student record will be permanently deleted from the database.</p>
    </div>
    
    <form method="post">
        @AntiForgery.GetHtml()
        <input type="submit" value="Yes, Delete Student" class="delete-button" />
        <a href="~/Students.cshtml" class="cancel-button">Cancel</a>
    </form>
</div>

<style>
    .delete-confirmation {
        max-width: 600px;
        margin: 20px auto;
        padding: 20px;
        border: 1px solid #ddd;
        border-radius: 5px;
        background-color: #fff;
    }
    
    .student-details {
        background-color: #f9f9f9;
        padding: 15px;
        border-radius: 5px;
        margin-bottom: 20px;
    }
    
    .student-details h3 {
        margin-top: 0;
        color: #333;
        border-bottom: 2px solid #4CAF50;
        padding-bottom: 10px;
    }
    
    dl {
        margin: 0;
    }
    
    dt {
        font-weight: bold;
        color: #555;
        margin-top: 10px;
        float: left;
        clear: left;
        width: 150px;
    }
    
    dd {
        margin-left: 160px;
        margin-bottom: 10px;
        color: #333;
    }
    
    .warning-message {
        background-color: #fff3cd;
        border: 1px solid #ffc107;
        border-radius: 5px;
        padding: 15px;
        margin-bottom: 20px;
    }
    
    .warning-message p {
        margin: 0;
        color: #856404;
    }
    
    .delete-button {
        background-color: #d9534f;
        color: white;
        padding: 12px 24px;
        border: none;
        border-radius: 4px;
        cursor: pointer;
        font-size: 16px;
        font-weight: bold;
    }
    
    .delete-button:hover {
        background-color: #c9302c;
    }
    
    .cancel-button {
        margin-left: 10px;
        padding: 12px 24px;
        text-decoration: none;
        color: #333;
        border: 1px solid #ccc;
        border-radius: 4px;
        display: inline-block;
        background-color: #fff;
    }
    
    .cancel-button:hover {
        background-color: #f5f5f5;
    }
    
    form {
        text-align: center;
        margin-top: 20px;
    }
</style>
